#=========================================================================
# Sparse Memory Image Test Suite
#=========================================================================

from SparseMemoryImage import SparseMemoryImage

def test_sparse_memory_img():

  sparse_mem_img = SparseMemoryImage()

  section_0 = [  0x000010000, [
                 0x00,
                 0x01,
                 0x02,
                 0x03,
                 0x04,
                 0x05,
                 0x06,
                 0x07 ]
              ]

  section_1 = [  0x000040000, [
                 0x00,
                 0x01,
                 0x02,
                 0x03,
                 0x04,
                 0x05,
                 0x06,
                 0x07 ]
              ]

  sparse_mem_img.load_section( section_0 )
  sparse_mem_img.load_section( section_1 )

  assert sparse_mem_img.num_sections()    == 2
  assert sparse_mem_img.read_section( 0 ) == section_0
  assert sparse_mem_img.read_section( 1 ) == section_1

# This is a throw away test. I created a test.cc file as below and compiled
# it using the maven cross compiler
#
# //--------
# // test.cc
# //--------
#
# int main() {
#  int a = 1;
#  int b = 2;
#  int c = a + b;
#  return 1;
# }
#
#def test_sparse_memory_img_from_file():
#
#  sparse_mem_img = SparseMemoryImage( filename = "test" )
#
#  section_1 = [4140, [232, 255, 189, 39, 4, 0, 177, 175, 2, 0, 17, 60, 248,
#244, 33, 146, 20, 0, 191, 175, 16, 0, 180, 175, 12, 0, 179, 175, 8, 0, 178,
#175, 28, 0, 32, 20, 2, 0, 20, 60, 2, 0, 19, 60, 244, 195, 148, 38, 2, 0,
#18, 60, 248, 195, 115, 38, 35, 152, 116, 2, 252, 244, 65, 142, 131, 152,
#19, 0, 255, 255, 115, 38, 43, 16, 51, 0, 9, 0, 64, 16, 1, 0, 33, 36, 128,
#16, 1, 0, 33, 16, 130, 2, 0, 0, 66, 140, 252, 244, 65, 174, 9, 248, 64, 0,
#252, 244, 65, 142, 43, 16, 51, 0, 247, 255, 64, 20, 1, 0, 1, 60, 56, 175,
#33, 36, 3, 0, 32, 16, 2, 0, 3, 60, 252, 195, 99, 36, 206, 43, 0, 12, 1, 0,
#1, 36, 248, 244, 33, 162, 20, 0, 191, 143, 16, 0, 180, 143, 12, 0, 179,
#143, 8, 0, 178, 143, 4, 0, 177, 143, 24, 0, 189, 39, 8, 0, 224, 3]]
#
#  section_64 = [26368, [184, 255, 189, 39, 43, 8, 100, 0, 64, 0, 185, 175,
#40, 0, 179, 175, 36, 0, 178, 175, 32, 0, 177, 175, 68, 0, 191, 175, 60, 0,
#184, 175, 56, 0, 183, 175, 52, 0, 182, 175, 48, 0, 181, 175, 44, 0, 180,
#175, 33, 200, 160, 3, 33, 136, 128, 0, 33, 144, 192, 0, 33, 152, 160, 0,
#72, 7, 192, 172, 63, 0, 32, 16, 188, 3, 162, 140, 168, 3, 164, 140, 92, 7,
#193, 140, 194, 23, 2, 0, 33, 16, 130, 0, 43, 16, 34, 0, 56, 0, 64, 16, 80,
#7, 194, 36, 2, 0, 24, 60, 248, 171, 24, 39, 33, 40, 0, 0, 64, 0, 20, 36,
#128, 0, 21, 36, 192, 0, 22, 36, 1, 0, 23, 36, 8, 0, 34, 175, 4, 0, 38, 39,
#0, 0, 100, 144, 1, 0, 99, 36, 192, 0, 130, 48, 55, 0, 84, 16, 60, 0, 85,
#16, 78, 0, 86, 16, 48, 0, 130, 44, 1, 0, 64, 20, 193, 44, 0, 12, 128, 32,
#4, 0, 33, 32, 4, 3, 0, 0, 130, 140, 8, 0, 64, 0, 33, 32, 0, 0, 33, 8, 0, 0,
#0, 0, 98, 144, 1, 0, 99, 36, 127, 0, 71, 48, 0, 22, 2, 0, 4, 56, 39, 0, 3,
#22, 2, 0, 37, 32, 135, 0, 7, 0, 33, 36, 247, 255, 64, 4, 80, 7, 68, 174,
#33, 32, 32, 3, 28, 0, 37, 175, 24, 0, 38, 175, 211, 23, 0, 12, 100, 7, 66,
#142, 33, 24, 32, 0, 88, 7, 87, 174, 0, 0, 33, 143, 28, 0, 37, 143, 24, 0,
#38, 143, 2, 8, 65, 112, 76, 7, 65, 174, 43, 8, 113, 0, 7, 0, 32, 16, 188,
#3, 98, 142, 168, 3, 100, 142, 92, 7, 65, 142, 194, 23, 2, 0, 33, 16, 130,
#0, 43, 16, 34, 0, 210, 255, 64, 20, 33, 232, 32, 3, 68, 0, 191, 143, 64, 0,
#185, 143, 60, 0, 184, 143, 56, 0, 183, 143, 52, 0, 182, 143, 48, 0, 181,
#143, 44, 0, 180, 143, 40, 0, 179, 143, 36, 0, 178, 143, 32, 0, 177, 143,
#72, 0, 189, 39, 8, 0, 224, 3, 104, 7, 66, 142, 63, 0, 132, 48, 2, 32, 130,
#112, 33, 8, 36, 0, 92, 7, 65, 174, 8, 26, 0, 8, 63, 0, 136, 48, 33, 8, 0,
#0, 33, 32, 0, 0, 0, 0, 98, 144, 1, 0, 99, 36, 127, 0, 71, 48, 0, 22, 2, 0,
#4, 56, 39, 0, 3, 22, 2, 0, 37, 32, 135, 0, 7, 0, 33, 36, 247, 255, 64, 4,
#100, 7, 66, 142, 192, 8, 8, 0, 33, 8, 65, 2, 2, 32, 130, 112, 4, 0, 55,
#172, 0, 0, 36, 172, 8, 26, 0, 8, 63, 0, 132, 48, 192, 32, 4, 0, 33, 32, 68,
#2, 4, 0, 128, 172, 8, 26, 0, 8, 33, 56, 0, 0, 33, 8, 0, 0, 0, 0, 98, 144,
#1, 0, 99, 36, 127, 0, 68, 48, 0, 22, 2, 0, 4, 32, 36, 0, 3, 22, 2, 0, 37,
#56, 228, 0, 7, 0, 33, 36, 247, 255, 64, 4, 33, 32, 0, 0, 33, 8, 0, 0, 0, 0,
#98, 144, 1, 0, 99, 36, 127, 0, 72, 48, 0, 22, 2, 0, 4, 64, 40, 0, 3, 22, 2,
#0, 37, 32, 136, 0, 7, 0, 33, 36, 247, 255, 64, 4, 100, 7, 66, 142, 192, 8,
#7, 0, 33, 8, 65, 2, 2, 16, 130, 112, 4, 0, 55, 172, 35, 16, 2, 0, 0, 0, 34,
#172, 8, 26, 0, 8, 112, 7, 66, 146, 255, 0, 4, 36, 187, 1, 68, 16, 112, 0,
#65, 48, 32, 0, 4, 36, 28, 2, 36, 16, 33, 0, 36, 40, 193, 1, 128, 20, 23, 2,
#52, 16, 80, 0, 4, 36, 193, 1, 36, 16, 48, 0, 4, 36, 132, 255, 36, 20, 180,
#3, 103, 142, 80, 0, 1, 36, 9, 2, 65, 16, 33, 64, 96, 0, 26, 28, 0, 8, 0, 0,
#100, 144, 104, 7, 66, 142, 1, 0, 99, 36, 2, 16, 130, 112, 33, 8, 34, 0, 92,
#7, 65, 174, 8, 26, 0, 8, 1, 0, 103, 144, 0, 0, 100, 144, 104, 7, 66, 142,
#0, 58, 7, 0, 37, 32, 228, 0, 2, 16, 130, 112, 2, 0, 99, 36, 33, 8, 34, 0,
#92, 7, 65, 174, 8, 26, 0, 8, 1, 0, 100, 144, 0, 0, 98, 144, 2, 0, 104, 144,
#3, 0, 103, 144, 0, 34, 4, 0, 37, 32, 130, 0, 0, 68, 8, 0, 104, 7, 66, 142,
#37, 32, 4, 1, 0, 62, 7, 0, 37, 32, 228, 0, 2, 16, 130, 112, 4, 0, 99, 36,
#33, 8, 34, 0, 92, 7, 65, 174, 8, 26, 0, 8, 33, 56, 0, 0, 33, 8, 0, 0, 0, 0,
#98, 144, 1, 0, 99, 36, 127, 0, 68, 48, 0, 22, 2, 0, 4, 32, 36, 0, 3, 22, 2,
#0, 37, 56, 228, 0, 7, 0, 33, 36, 247, 255, 64, 4, 33, 32, 0, 0, 33, 8, 0,
#0, 0, 0, 98, 144, 1, 0, 99, 36, 127, 0, 72, 48, 0, 22, 2, 0, 4, 64, 40, 0,
#3, 22, 2, 0, 37, 32, 136, 0, 7, 0, 33, 36, 247, 255, 64, 4, 100, 7, 66,
#142, 192, 8, 7, 0, 33, 8, 65, 2, 2, 32, 130, 112, 4, 0, 55, 172, 0, 0, 36,
#172, 8, 26, 0, 8, 33, 32, 0, 0, 33, 8, 0, 0, 0, 0, 98, 144, 1, 0, 99, 36,
#127, 0, 71, 48, 0, 22, 2, 0, 4, 56, 39, 0, 3, 22, 2, 0, 37, 32, 135, 0, 7,
#0, 33, 36, 247, 255, 64, 4, 192, 8, 4, 0, 33, 8, 65, 2, 4, 0, 32, 172, 8,
#26, 0, 8, 33, 32, 0, 0, 33, 8, 0, 0, 0, 0, 98, 144, 1, 0, 99, 36, 127, 0,
#71, 48, 0, 22, 2, 0, 4, 56, 39, 0, 3, 22, 2, 0, 37, 32, 135, 0, 7, 0, 33,
#36, 247, 255, 64, 4, 192, 8, 4, 0, 33, 8, 65, 2, 6, 0, 2, 36, 4, 0, 34,
#172, 8, 26, 0, 8, 33, 32, 0, 0, 33, 8, 0, 0, 0, 0, 98, 144, 1, 0, 99, 36,
#127, 0, 71, 48, 0, 22, 2, 0, 4, 56, 39, 0, 3, 22, 2, 0, 37, 32, 135, 0, 7,
#0, 33, 36, 247, 255, 64, 4, 192, 8, 4, 0, 33, 8, 65, 2, 4, 0, 32, 172, 8,
#26, 0, 8, 33, 56, 0, 0, 33, 8, 0, 0, 0, 0, 98, 144, 1, 0, 99, 36, 127, 0,
#68, 48, 0, 22, 2, 0, 4, 32, 36, 0, 3, 22, 2, 0, 37, 56, 228, 0, 7, 0, 33,
#36, 247, 255, 64, 4, 33, 32, 0, 0, 33, 8, 0, 0, 0, 0, 98, 144, 1, 0, 99,
#36, 127, 0, 72, 48, 0, 22, 2, 0, 4, 64, 40, 0, 3, 22, 2, 0, 37, 32, 136, 0,
#7, 0, 33, 36, 247, 255, 64, 4, 192, 8, 7, 0, 33, 8, 65, 2, 0, 0, 36, 172,
#2, 0, 4, 36, 4, 0, 36, 172, 8, 26, 0, 8, 137, 1, 160, 16, 33, 32, 160, 0,
#72, 7, 165, 140, 33, 8, 64, 2, 33, 16, 128, 0, 12, 0, 39, 140, 0, 0, 42,
#140, 4, 0, 41, 140, 8, 0, 40, 140, 12, 0, 71, 172, 8, 0, 39, 143, 16, 0,
#33, 36, 0, 0, 74, 172, 4, 0, 73, 172, 8, 0, 72, 172, 16, 0, 66, 36, 244,
#255, 39, 20, 8, 0, 41, 143, 0, 0, 232, 140, 4, 0, 231, 140, 8, 0, 33, 141,
#0, 0, 72, 172, 4, 0, 71, 172, 8, 0, 65, 172, 72, 7, 68, 174, 8, 26, 0, 8,
#72, 7, 68, 142, 33, 16, 64, 2, 33, 8, 128, 0, 80, 7, 135, 36, 0, 0, 43,
#140, 4, 0, 42, 140, 8, 0, 41, 140, 12, 0, 40, 140, 16, 0, 33, 36, 0, 0, 75,
#172, 4, 0, 74, 172, 8, 0, 73, 172, 12, 0, 72, 172, 16, 0, 66, 36, 245, 255,
#39, 20, 8, 0, 40, 140, 0, 0, 39, 140, 4, 0, 33, 140, 8, 0, 72, 172, 0, 0,
#71, 172, 4, 0, 65, 172, 72, 7, 133, 172, 33, 40, 128, 0, 8, 26, 0, 8, 33,
#32, 0, 0, 33, 8, 0, 0, 0, 0, 98, 144, 1, 0, 99, 36, 127, 0, 71, 48, 0, 22,
#2, 0, 4, 56, 39, 0, 3, 22, 2, 0, 37, 32, 135, 0, 7, 0, 33, 36, 247, 255,
#64, 4, 80, 7, 68, 174, 33, 8, 0, 0, 33, 32, 0, 0, 0, 0, 98, 144, 1, 0, 99,
#36, 127, 0, 71, 48, 0, 22, 2, 0, 4, 56, 39, 0, 3, 22, 2, 0, 37, 32, 135, 0,
#7, 0, 33, 36, 247, 255, 64, 4, 76, 7, 68, 174, 88, 7, 87, 174, 8, 26, 0, 8,
#33, 32, 0, 0, 33, 8, 0, 0, 0, 0, 98, 144, 1, 0, 99, 36, 127, 0, 71, 48, 0,
#22, 2, 0, 4, 56, 39, 0, 3, 22, 2, 0, 37, 32, 135, 0, 7, 0, 33, 36, 247,
#255, 64, 4, 80, 7, 68, 174, 88, 7, 87, 174, 8, 26, 0, 8, 33, 32, 0, 0, 33,
#8, 0, 0, 0, 0, 98, 144, 1, 0, 99, 36, 127, 0, 71, 48, 0, 22, 2, 0, 4, 56,
#39, 0, 3, 22, 2, 0, 37, 32, 135, 0, 7, 0, 33, 36, 247, 255, 64, 4, 76, 7,
#68, 174, 8, 26, 0, 8, 2, 0, 1, 36, 88, 7, 65, 174, 84, 7, 67, 174, 33, 32,
#0, 0, 33, 8, 0, 0, 0, 0, 98, 144, 1, 0, 99, 36, 127, 0, 71, 48, 0, 22, 2,
#0, 4, 56, 39, 0, 3, 22, 2, 0, 37, 32, 135, 0, 7, 0, 33, 36, 247, 255, 64,
#4, 33, 24, 100, 0, 8, 26, 0, 8, 33, 32, 0, 0, 33, 8, 0, 0, 0, 0, 98, 144,
#1, 0, 99, 36, 127, 0, 71, 48, 0, 22, 2, 0, 4, 56, 39, 0, 3, 22, 2, 0, 37,
#32, 135, 0, 7, 0, 33, 36, 247, 255, 64, 4, 192, 8, 4, 0, 33, 8, 65, 2, 3,
#0, 2, 36, 0, 0, 35, 172, 4, 0, 34, 172, 33, 32, 0, 0, 33, 8, 0, 0, 0, 0,
#98, 144, 1, 0, 99, 36, 127, 0, 71, 48, 0, 22, 2, 0, 4, 56, 39, 0, 3, 22, 2,
#0, 37, 32, 135, 0, 7, 0, 33, 36, 247, 255, 64, 4, 33, 24, 100, 0, 8, 26, 0,
#8, 33, 16, 0, 0, 33, 8, 0, 0, 0, 0, 100, 144, 1, 0, 99, 36, 127, 0, 135,
#48, 0, 38, 4, 0, 4, 56, 39, 0, 3, 38, 4, 0, 37, 16, 71, 0, 7, 0, 33, 36,
#247, 255, 128, 4, 33, 32, 32, 3, 20, 0, 34, 175, 28, 0, 37, 175, 24, 0, 38,
#175, 211, 23, 0, 12, 20, 0, 34, 143, 100, 7, 68, 142, 33, 24, 32, 0, 192,
#8, 2, 0, 0, 0, 34, 143, 33, 8, 65, 2, 4, 0, 55, 172, 2, 16, 68, 112, 0, 0,
#34, 172, 28, 0, 37, 143, 24, 0, 38, 143, 8, 26, 0, 8, 33, 32, 32, 3, 28, 0,
#37, 175, 24, 0, 38, 175, 211, 23, 0, 12, 33, 24, 32, 0, 100, 7, 66, 142, 3,
#26, 0, 8, 33, 56, 0, 0, 33, 8, 0, 0, 0, 0, 98, 144, 1, 0, 99, 36, 127, 0,
#68, 48, 0, 22, 2, 0, 4, 32, 36, 0, 3, 22, 2, 0, 37, 56, 228, 0, 7, 0, 33,
#36, 247, 255, 64, 4, 33, 32, 0, 0, 33, 8, 0, 0, 0, 0, 98, 144, 1, 0, 99,
#36, 127, 0, 72, 48, 0, 22, 2, 0, 4, 64, 40, 0, 3, 22, 2, 0, 37, 32, 136, 0,
#7, 0, 33, 36, 247, 255, 64, 4, 100, 7, 66, 142, 192, 8, 7, 0, 33, 8, 65, 2,
#2, 32, 130, 112, 4, 0, 7, 36, 4, 0, 39, 172, 0, 0, 36, 172, 8, 26, 0, 8,
#33, 16, 0, 0, 33, 8, 0, 0, 0, 0, 100, 144, 1, 0, 99, 36, 127, 0, 135, 48,
#0, 38, 4, 0, 4, 56, 39, 0, 3, 38, 4, 0, 37, 16, 71, 0, 7, 0, 33, 36, 247,
#255, 128, 4, 33, 32, 32, 3, 20, 0, 34, 175, 28, 0, 37, 175, 24, 0, 38, 175,
#211, 23, 0, 12, 20, 0, 34, 143, 100, 7, 68, 142, 33, 24, 32, 0, 192, 8, 2,
#0, 0, 0, 34, 143, 33, 8, 65, 2, 4, 0, 9, 36, 2, 16, 68, 112, 4, 0, 41, 172,
#0, 0, 34, 172, 28, 0, 37, 143, 24, 0, 38, 143, 8, 26, 0, 8, 33, 32, 0, 0,
#33, 8, 0, 0, 0, 0, 98, 144, 1, 0, 99, 36, 127, 0, 71, 48, 0, 22, 2, 0, 4,
#56, 39, 0, 3, 22, 2, 0, 37, 32, 135, 0, 7, 0, 33, 36, 247, 255, 64, 4, 192,
#8, 4, 0, 33, 8, 65, 2, 5, 0, 2, 36, 0, 0, 35, 172, 4, 0, 34, 172, 33, 32,
#0, 0, 33, 8, 0, 0, 0, 0, 98, 144, 1, 0, 99, 36, 127, 0, 71, 48, 0, 22, 2,
#0, 4, 56, 39, 0, 3, 22, 2, 0, 37, 32, 135, 0, 7, 0, 33, 36, 247, 255, 64,
#4, 33, 24, 100, 0, 8, 26, 0, 8, 33, 16, 64, 2, 33, 8, 0, 0, 128, 0, 65,
#172, 4, 0, 33, 36, 132, 0, 87, 172, 8, 0, 66, 36, 251, 255, 52, 20, 8, 26,
#0, 8, 33, 32, 0, 0, 33, 8, 0, 0, 0, 0, 98, 144, 1, 0, 99, 36, 127, 0, 71,
#48, 0, 22, 2, 0, 4, 56, 39, 0, 3, 22, 2, 0, 37, 32, 135, 0, 7, 0, 33, 36,
#247, 255, 64, 4, 196, 3, 100, 174, 8, 26, 0, 8, 33, 64, 96, 0, 33, 56, 0,
#0, 15, 0, 65, 48, 13, 0, 36, 44, 206, 253, 128, 16, 2, 0, 9, 60, 128, 8, 1,
#0, 184, 172, 41, 37, 33, 8, 33, 1, 0, 0, 33, 140, 8, 0, 32, 0, 2, 0, 32,
#16, 16, 0, 7, 36, 197, 253, 39, 20, 33, 56, 0, 0, 104, 26, 0, 8, 1, 0, 106,
#144, 0, 0, 97, 144, 2, 0, 105, 144, 3, 0, 100, 144, 0, 82, 10, 0, 37, 8,
#65, 1, 0, 76, 9, 0, 37, 8, 33, 1, 0, 38, 4, 0, 37, 8, 129, 0, 4, 0, 99, 36,
#87, 254, 32, 16, 112, 0, 68, 48, 16, 0, 132, 56, 0, 22, 2, 0, 10, 56, 4, 1,
#3, 22, 2, 0, 33, 8, 225, 0, 80, 254, 65, 4, 0, 0, 33, 140, 92, 7, 65, 174,
#8, 26, 0, 8, 1, 0, 106, 144, 0, 0, 97, 144, 2, 0, 105, 144, 3, 0, 100, 144,
#0, 82, 10, 0, 37, 8, 65, 1, 0, 76, 9, 0, 37, 8, 33, 1, 0, 38, 4, 0, 37, 8,
#129, 0, 8, 0, 99, 36, 51, 28, 0, 8, 1, 0, 100, 144, 0, 0, 97, 144, 2, 0,
#99, 36, 0, 34, 4, 0, 37, 8, 129, 0, 0, 12, 1, 0, 3, 12, 1, 0, 51, 28, 0, 8,
#1, 0, 100, 144, 0, 0, 97, 144, 2, 0, 99, 36, 0, 34, 4, 0, 37, 8, 129, 0,
#51, 28, 0, 8, 33, 8, 0, 0, 33, 32, 0, 0, 0, 0, 105, 144, 1, 0, 99, 36, 127,
#0, 42, 49, 0, 78, 9, 0, 4, 80, 138, 0, 3, 78, 9, 0, 37, 8, 42, 0, 7, 0,
#132, 36, 247, 255, 32, 5, 51, 28, 0, 8, 33, 32, 192, 0, 20, 0, 34, 175, 28,
#0, 37, 175, 24, 0, 38, 175, 12, 0, 39, 175, 16, 0, 40, 175, 211, 23, 0, 12,
#33, 24, 32, 0, 20, 0, 34, 143, 4, 0, 33, 143, 28, 0, 37, 143, 24, 0, 38,
#143, 12, 0, 39, 143, 16, 0, 40, 143, 51, 28, 0, 8, 252, 255, 1, 36, 3, 0,
#99, 36, 36, 24, 97, 0, 0, 0, 97, 140, 4, 0, 99, 36, 92, 7, 65, 174, 8, 26,
#0, 8, 184, 3, 103, 142, 104, 26, 0, 8, 176, 3, 103, 142, 104, 26, 0, 8,
#152, 248, 189, 39, 33, 32, 160, 3, 247, 26, 0, 8]]
#
#  assert sparse_mem_img.num_sections()     == 473
#  assert sparse_mem_img.read_section( 1  ) == section_1
#  assert sparse_mem_img.read_section( 64 ) == section_64
